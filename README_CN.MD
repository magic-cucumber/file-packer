# file-packer

[English Doc](README.MD)

## 1. 简介

file-packer 是一个用于文件加密和解密的命令行工具。它能够将整个文件夹加密为一个归档文件，并能将归档文件解密还原为原始文件夹结构。该程序使用了简单的混淆技术，通过对文件块进行随机重排来避免网盘类应用的审查。

主要特性：
- 跨平台支持：支持 Linux、macOS 和 Windows 系统
- 高效处理：使用 Okio 进行高性能文件 I/O 操作
- 数据安全：采用 CBOR 序列化元数据，对文件块进行随机重排
- 并发处理：利用 Kotlin 协程实现并发文件处理，提高处理速度
- 命令行界面：简洁直观的命令行操作界面

## 2. 基本使用

### 加密文件夹

要将文件夹加密为归档文件，请使用以下命令：

```bash
./file-packer encrypt <输入文件夹路径> [--output <输出文件夹路径>] [--block-size <块大小(KB)>] [--debug]
```

示例：
```bash
./file-packer encrypt test
```

执行上述命令后，将在当前目录下生成一个名为 test-encrypt 的文件夹，其中包含两个文件：
- index.cbor: 存储文件元数据的索引文件
- payload.bin: 存储实际文件数据的数据文件

### 解密归档文件

要将归档文件解密还原为原始文件夹，请使用以下命令：

```bash
./file-packer decrypt <归档文件夹路径> [--output <输出文件夹路径>] [--debug]
```

示例：
```bash
./file-packer decrypt test-encrypt --output test-decrypt
```

执行上述命令后，将生成一个名为 test-decrypt 的文件夹，其中包含与原始文件夹相同的文件结构和内容。

## 3. 指令以及参数事项

### encrypt 命令

用于加密文件夹，将其转换为归档文件。

参数说明：
- `<输入文件夹路径>`: 要加密的文件夹路径（必需）
- `--output`: 输出文件夹路径，默认为输入文件夹名+"-encrypt"
- `--block-size`: 块大小，单位为 KB，默认为 128KB
- `--debug`: 启用调试日志
- `--helper` 创建一键解包脚本（只支持与加密者相同的平台进行一键解包）

注意事项：
1. 输入文件夹必须存在且为目录
2. 输出文件夹不能已存在
3. 块大小决定了文件被分割的粒度，较小的块可以提供更好的数据混淆效果，但可能会增加处理时间

### decrypt 命令

用于解密归档文件，将其还原为原始文件夹。

参数说明：
- `<归档文件夹路径>`: 包含 index.cbor 和 payload.bin 的归档文件夹路径（必需）
- `--output`: 输出文件夹路径，默认为随机生成的 UUID 字符串
- `--debug`: 启用调试日志

注意事项：
1. 归档文件夹必须包含 index.cbor 和 payload.bin 两个文件
2. 输出文件夹不能已存在
3. 解密过程需要完整的索引文件和数据文件，缺一不可


